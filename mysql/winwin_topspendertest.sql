-- for complex query "Top spender in Nov2021" only

drop database winwin;

INSERT INTO user VALUES
('UID10001', 'un1', 'pass1', 'email1', 'fn1', 'ln1', '1', 'customer'),
('UID10002', 'un2', 'pass2', 'email2', 'fn2', 'ln2', '2', 'customer'),
('UID10003', 'un3', 'pass3', 'email3', 'fn3', 'ln3', '3', 'customer'),
('UID10004', 'un4', 'pass4', 'email4', 'fn4', 'ln4', '4', 'customer'),
('UID10005', 'un5', 'pass5', 'email5', 'fn5', 'ln5', '5', 'customer'),
('UID10006', 'un6', 'pass6', 'email6', 'fn6', 'ln6', '6', 'customer'),
('UID10007', 'un7', 'pass7', 'email7', 'fn7', 'ln7', '7', 'customer'),
('UID10008', 'un8', 'pass8', 'email8', 'fn8', 'ln8', '8', 'customer'),
('UID10009', 'un9', 'pass9', 'email9', 'fn9', 'ln9', '9', 'customer'),
('UID10010', 'un10', 'pass10', 'email10', 'fn10', 'ln10', '10', 'customer'),
('UID10011', 'un11', 'pass11', 'email11', 'fn11', 'ln11', '11', 'customer'),
('UID10012', 'un12', 'pass12', 'email12', 'fn12', 'ln12', '12', 'customer'),
('UID10013', 'un13', 'pass13', 'email13', 'fn13', 'ln13', '13', 'customer'),
('UID10014', 'un14', 'pass14', 'email14', 'fn14', 'ln14', '14', 'customer'),
('UID10015', 'un15', 'pass15', 'email15', 'fn15', 'ln15', '15', 'customer'),
('UID10016', 'un16', 'pass16', 'email16', 'fn16', 'ln16', '16', 'customer'),
('UID10017', 'un17', 'pass17', 'email17', 'fn17', 'ln17', '17', 'customer'),
('UID10018', 'un18', 'pass18', 'email18', 'fn18', 'ln18', '18', 'customer'),
('UID10019', 'un19', 'pass19', 'email19', 'fn19', 'ln19', '19', 'customer'),
('UID10020', 'un20', 'pass20', 'email20', 'fn20', 'ln20', '20', 'customer'),
('UID10021', 'un21', 'pass21', 'email21', 'fn21', 'ln21', '21', 'customer'),
('UID10022', 'un22', 'pass22', 'email22', 'fn22', 'ln22', '22', 'customer'),
('UID10023', 'un23', 'pass23', 'email23', 'fn23', 'ln23', '23', 'customer'),
('UID10024', 'un24', 'pass24', 'email24', 'fn24', 'ln24', '24', 'customer'),
('UID10025', 'un25', 'pass25', 'email25', 'fn25', 'ln25', '25', 'customer'),
('UID10026', 'un26', 'pass26', 'email26', 'fn26', 'ln26', '26', 'customer'),
('UID10027', 'un27', 'pass27', 'email27', 'fn27', 'ln27', '27', 'customer'),
('UID10028', 'un28', 'pass28', 'email28', 'fn28', 'ln28', '28', 'customer'),
('UID10029', 'un29', 'pass29', 'email29', 'fn29', 'ln29', '29', 'customer'),
('UID10030', 'un30', 'pass30', 'email30', 'fn30', 'ln30', '30', 'customer'),
('UID10031', 'un31', 'pass31', 'email31', 'fn31', 'ln31', '31', 'customer'),
('UID10032', 'un32', 'pass32', 'email32', 'fn32', 'ln32', '32', 'customer'),
('UID10033', 'un33', 'pass33', 'email33', 'fn33', 'ln33', '33', 'customer'),
('UID10034', 'un34', 'pass34', 'email34', 'fn34', 'ln34', '34', 'customer'),
('UID10035', 'un35', 'pass35', 'email35', 'fn35', 'ln35', '35', 'customer'),
('UID10036', 'un36', 'pass36', 'email36', 'fn36', 'ln36', '36', 'customer'),
('UID10037', 'un37', 'pass37', 'email37', 'fn37', 'ln37', '37', 'customer'),
('UID10038', 'un38', 'pass38', 'email38', 'fn38', 'ln38', '38', 'customer'),
('UID10039', 'un39', 'pass39', 'email39', 'fn39', 'ln39', '39', 'customer'),
('UID10040', 'un40', 'pass40', 'email40', 'fn40', 'ln40', '40', 'customer'),
('UID10041', 'un41', 'pass41', 'email41', 'fn41', 'ln41', '41', 'customer'),
('UID10042', 'un42', 'pass42', 'email42', 'fn42', 'ln42', '42', 'customer'),
('UID10043', 'un43', 'pass43', 'email43', 'fn43', 'ln43', '43', 'customer'),
('UID10044', 'un44', 'pass44', 'email44', 'fn44', 'ln44', '44', 'customer'),
('UID10045', 'un45', 'pass45', 'email45', 'fn45', 'ln45', '45', 'customer'),
('UID10046', 'un46', 'pass46', 'email46', 'fn46', 'ln46', '46', 'customer'),
('UID10047', 'un47', 'pass47', 'email47', 'fn47', 'ln47', '47', 'customer'),
('UID10048', 'un48', 'pass48', 'email48', 'fn48', 'ln48', '48', 'customer'),
('UID10049', 'un49', 'pass49', 'email49', 'fn49', 'ln49', '49', 'customer'),
('UID10050', 'un50', 'pass50', 'email50', 'fn50', 'ln50', '50', 'customer'),
('UID10051', 'un51', 'pass51', 'email51', 'fn51', 'ln51', '51', 'customer'),
('UID10052', 'un52', 'pass52', 'email52', 'fn52', 'ln52', '52', 'customer'),
('UID10053', 'un53', 'pass53', 'email53', 'fn53', 'ln53', '53', 'customer'),
('UID10054', 'un54', 'pass54', 'email54', 'fn54', 'ln54', '54', 'customer'),
('UID10055', 'un55', 'pass55', 'email55', 'fn55', 'ln55', '55', 'customer'),
('UID10056', 'un56', 'pass56', 'email56', 'fn56', 'ln56', '56', 'customer'),
('UID10057', 'un57', 'pass57', 'email57', 'fn57', 'ln57', '57', 'customer'),
('UID10058', 'un58', 'pass58', 'email58', 'fn58', 'ln58', '58', 'customer'),
('UID10059', 'un59', 'pass59', 'email59', 'fn59', 'ln59', '59', 'customer'),
('UID10060', 'un60', 'pass60', 'email60', 'fn60', 'ln60', '60', 'customer'),
('UID10061', 'un61', 'pass61', 'email61', 'fn61', 'ln61', '61', 'customer'),
('UID10062', 'un62', 'pass62', 'email62', 'fn62', 'ln62', '62', 'customer'),
('UID10063', 'un63', 'pass63', 'email63', 'fn63', 'ln63', '63', 'customer'),
('UID10064', 'un64', 'pass64', 'email64', 'fn64', 'ln64', '64', 'customer'),
('UID10065', 'un65', 'pass65', 'email65', 'fn65', 'ln65', '65', 'customer'),
('UID10066', 'un66', 'pass66', 'email66', 'fn66', 'ln66', '66', 'customer'),
('UID10067', 'un67', 'pass67', 'email67', 'fn67', 'ln67', '67', 'customer'),
('UID10068', 'un68', 'pass68', 'email68', 'fn68', 'ln68', '68', 'customer'),
('UID10069', 'un69', 'pass69', 'email69', 'fn69', 'ln69', '69', 'customer'),
('UID10070', 'un70', 'pass70', 'email70', 'fn70', 'ln70', '70', 'customer');

INSERT INTO customer values
('UID10001', 'credit_card'),
('UID10002', 'credit_card'),
('UID10003', 'bank_transfer'),
('UID10004', 'bank_transfer'),
('UID10005', 'cash'),
('UID10006', 'bank_transfer'),
('UID10007', 'cash'),
('UID10008', 'bank_transfer'),
('UID10009', 'credit_card'),
('UID10010', 'cash'),
('UID10011', 'cash'),
('UID10012', 'credit_card'),
('UID10013', 'credit_card'),
('UID10014', 'credit_card'),
('UID10015', 'credit_card'),
('UID10016', 'cash'),
('UID10017', 'cash'),
('UID10018', 'credit_card'),
('UID10019', 'cash'),
('UID10020', 'bank_transfer'),
('UID10021', 'bank_transfer'),
('UID10022', 'cash'),
('UID10023', 'credit_card'),
('UID10024', 'cash'),
('UID10025', 'credit_card'),
('UID10026', 'bank_transfer'),
('UID10027', 'bank_transfer'),
('UID10028', 'cash'),
('UID10029', 'bank_transfer'),
('UID10030', 'cash'),
('UID10031', 'bank_transfer'),
('UID10032', 'cash'),
('UID10033', 'cash'),
('UID10034', 'cash'),
('UID10035', 'cash'),
('UID10036', 'cash'),
('UID10037', 'cash'),
('UID10038', 'cash'),
('UID10039', 'cash'),
('UID10040', 'cash'),
('UID10041', 'credit_card'),
('UID10042', 'bank_transfer'),
('UID10043', 'cash'),
('UID10044', 'credit_card'),
('UID10045', 'credit_card'),
('UID10046', 'cash'),
('UID10047', 'cash'),
('UID10048', 'credit_card'),
('UID10049', 'bank_transfer'),
('UID10050', 'cash'),
('UID10051', 'cash'),
('UID10052', 'credit_card'),
('UID10053', 'credit_card'),
('UID10054', 'credit_card'),
('UID10055', 'bank_transfer'),
('UID10056', 'cash'),
('UID10057', 'bank_transfer'),
('UID10058', 'cash'),
('UID10059', 'cash'),
('UID10060', 'credit_card'),
('UID10061', 'credit_card'),
('UID10062', 'cash'),
('UID10063', 'cash'),
('UID10064', 'bank_transfer'),
('UID10065', 'bank_transfer'),
('UID10066', 'cash'),
('UID10067', 'bank_transfer'),
('UID10068', 'cash'),
('UID10069', 'bank_transfer'),
('UID10070', 'bank_transfer');

INSERT INTO ride values
('RDE10001','UID10001','UID00002','completed',45,45,45,45,1,timestamp("2021-11-01 11:19:00"),timestamp("2021-11-01 11:19:00"),5,'comment'),
('RDE10002','UID10002','UID00003','completed',45,45,45,45,1,timestamp("2021-11-01 11:29:00"),timestamp("2021-11-01 11:29:00"),5,'comment'),
('RDE10003','UID10003','UID00005','completed',45,45,45,45,1,timestamp("2021-11-01 11:28:00"),timestamp("2021-11-01 11:28:00"),5,'comment'),
('RDE10004','UID10003','UID00002','completed',45,45,45,45,1,timestamp("2021-11-01 11:40:00"),timestamp("2021-11-01 11:40:00"),5,'comment'),
('RDE10005','UID10003','UID00003','completed',45,45,45,45,1,timestamp("2021-11-01 11:48:00"),timestamp("2021-11-01 11:48:00"),5,'comment'),
('RDE10006','UID10003','UID00005','completed',45,45,45,45,1,timestamp("2021-11-01 11:36:00"),timestamp("2021-11-01 11:36:00"),5,'comment'),
('RDE10007','UID10007','UID00002','completed',45,45,45,45,1,timestamp("2021-11-01 11:45:00"),timestamp("2021-11-01 11:45:00"),5,'comment'),
('RDE10008','UID10008','UID00003','completed',45,45,45,45,1,timestamp("2021-11-01 11:40:00"),timestamp("2021-11-01 11:40:00"),5,'comment'),
('RDE10009','UID10009','UID00005','completed',45,45,45,45,1,timestamp("2021-11-01 11:16:00"),timestamp("2021-11-01 11:16:00"),5,'comment'),
('RDE10010','UID10010','UID00002','completed',45,45,45,45,1,timestamp("2021-11-10 11:16:00"),timestamp("2021-11-10 11:16:00"),5,'comment'),
('RDE10011','UID10011','UID00003','completed',45,45,45,45,1,timestamp("2021-11-10 11:16:00"),timestamp("2021-11-10 11:16:00"),5,'comment'),
('RDE10012','UID10012','UID00005','completed',45,45,45,45,1,timestamp("2021-11-10 11:43:00"),timestamp("2021-11-10 11:43:00"),5,'comment'),
('RDE10013','UID10013','UID00002','completed',45,45,45,45,1,timestamp("2021-11-10 11:47:00"),timestamp("2021-11-10 11:47:00"),5,'comment'),
('RDE10014','UID10014','UID00003','completed',45,45,45,45,1,timestamp("2021-11-10 11:40:00"),timestamp("2021-11-10 11:40:00"),5,'comment'),
('RDE10015','UID10015','UID00005','completed',45,45,45,45,1,timestamp("2021-11-10 11:35:00"),timestamp("2021-11-10 11:35:00"),5,'comment'),
('RDE10016','UID10016','UID00002','completed',45,45,45,45,1,timestamp("2021-11-10 11:55:00"),timestamp("2021-11-10 11:55:00"),5,'comment'),
('RDE10017','UID10017','UID00003','completed',45,45,45,45,1,timestamp("2021-11-10 11:34:00"),timestamp("2021-11-10 11:34:00"),5,'comment'),
('RDE10018','UID10018','UID00005','completed',45,45,45,45,1,timestamp("2021-11-10 11:46:00"),timestamp("2021-11-10 11:46:00"),5,'comment'),
('RDE10019','UID10019','UID00002','completed',45,45,45,45,1,timestamp("2021-11-10 11:18:00"),timestamp("2021-11-10 11:18:00"),5,'comment'),
('RDE10020','UID10020','UID00002','completed',45,45,45,45,1,timestamp("2021-11-11 11:31:00"),timestamp("2021-11-11 11:31:00"),5,'comment'),
('RDE10021','UID10021','UID00003','completed',45,45,45,45,1,timestamp("2021-11-11 11:43:00"),timestamp("2021-11-11 11:43:00"),5,'comment'),
('RDE10022','UID10022','UID00005','completed',45,45,45,45,1,timestamp("2021-11-11 11:44:00"),timestamp("2021-11-11 11:44:00"),5,'comment'),
('RDE10023','UID10023','UID00002','completed',45,45,45,45,1,timestamp("2021-11-11 11:44:00"),timestamp("2021-11-11 11:44:00"),5,'comment'),
('RDE10024','UID10024','UID00003','completed',45,45,45,45,1,timestamp("2021-11-11 11:53:00"),timestamp("2021-11-11 11:53:00"),5,'comment'),
('RDE10025','UID10025','UID00005','completed',45,45,45,45,1,timestamp("2021-11-11 11:17:00"),timestamp("2021-11-11 11:17:00"),5,'comment'),
('RDE10026','UID10026','UID00002','completed',45,45,45,45,1,timestamp("2021-11-11 11:41:00"),timestamp("2021-11-11 11:41:00"),5,'comment'),
('RDE10027','UID10027','UID00003','completed',45,45,45,45,1,timestamp("2021-11-11 11:35:00"),timestamp("2021-11-11 11:35:00"),5,'comment'),
('RDE10028','UID10028','UID00005','completed',45,45,45,45,1,timestamp("2021-11-11 11:46:00"),timestamp("2021-11-11 11:46:00"),5,'comment'),
('RDE10029','UID10029','UID00002','completed',45,45,45,45,1,timestamp("2021-11-11 11:31:00"),timestamp("2021-11-11 11:31:00"),5,'comment'),
('RDE10030','UID10030','UID00002','completed',45,45,45,45,1,timestamp("2021-11-12 11:29:00"),timestamp("2021-11-12 11:29:00"),5,'comment'),
('RDE10031','UID10031','UID00003','completed',45,45,45,45,1,timestamp("2021-11-12 11:33:00"),timestamp("2021-11-12 11:33:00"),5,'comment'),
('RDE10032','UID10032','UID00005','completed',45,45,45,45,1,timestamp("2021-11-12 11:44:00"),timestamp("2021-11-12 11:44:00"),5,'comment'),
('RDE10033','UID10033','UID00002','completed',45,45,45,45,1,timestamp("2021-11-12 11:37:00"),timestamp("2021-11-12 11:37:00"),5,'comment'),
('RDE10034','UID10034','UID00003','completed',45,45,45,45,1,timestamp("2021-11-12 11:46:00"),timestamp("2021-11-12 11:46:00"),5,'comment'),
('RDE10035','UID10035','UID00005','completed',45,45,45,45,1,timestamp("2021-11-12 11:19:00"),timestamp("2021-11-12 11:19:00"),5,'comment'),
('RDE10036','UID10036','UID00002','completed',45,45,45,45,1,timestamp("2021-11-12 11:47:00"),timestamp("2021-11-12 11:47:00"),5,'comment'),
('RDE10037','UID10037','UID00003','completed',45,45,45,45,1,timestamp("2021-11-12 11:11:00"),timestamp("2021-11-12 11:11:00"),5,'comment'),
('RDE10038','UID10038','UID00005','completed',45,45,45,45,1,timestamp("2021-11-12 11:30:00"),timestamp("2021-11-12 11:30:00"),5,'comment'),
('RDE10039','UID10039','UID00002','completed',45,45,45,45,1,timestamp("2021-11-12 11:42:00"),timestamp("2021-11-12 11:42:00"),5,'comment'),
('RDE10040','UID10040','UID00002','completed',45,45,45,45,1,timestamp("2021-11-13 11:22:00"),timestamp("2021-11-13 11:22:00"),5,'comment'),
('RDE10041','UID10041','UID00003','completed',45,45,45,45,1,timestamp("2021-11-13 11:44:00"),timestamp("2021-11-13 11:44:00"),5,'comment'),
('RDE10042','UID10042','UID00005','completed',45,45,45,45,1,timestamp("2021-11-13 11:31:00"),timestamp("2021-11-13 11:31:00"),5,'comment'),
('RDE10043','UID10043','UID00002','completed',45,45,45,45,1,timestamp("2021-11-13 11:41:00"),timestamp("2021-11-13 11:41:00"),5,'comment'),
('RDE10044','UID10044','UID00003','completed',45,45,45,45,1,timestamp("2021-11-13 11:35:00"),timestamp("2021-11-13 11:35:00"),5,'comment'),
('RDE10045','UID10045','UID00005','completed',45,45,45,45,1,timestamp("2021-11-13 11:22:00"),timestamp("2021-11-13 11:22:00"),5,'comment'),
('RDE10046','UID10046','UID00002','completed',45,45,45,45,1,timestamp("2021-11-13 11:53:00"),timestamp("2021-11-13 11:53:00"),5,'comment'),
('RDE10047','UID10047','UID00003','completed',45,45,45,45,1,timestamp("2021-11-13 11:38:00"),timestamp("2021-11-13 11:38:00"),5,'comment'),
('RDE10048','UID10048','UID00005','completed',45,45,45,45,1,timestamp("2021-11-13 11:55:00"),timestamp("2021-11-13 11:55:00"),5,'comment'),
('RDE10049','UID10049','UID00002','completed',45,45,45,45,1,timestamp("2021-11-13 11:54:00"),timestamp("2021-11-13 11:54:00"),5,'comment'),
('RDE10050','UID10050','UID00002','completed',45,45,45,45,1,timestamp("2021-11-14 11:41:00"),timestamp("2021-11-14 11:41:00"),5,'comment'),
('RDE10051','UID10051','UID00003','completed',45,45,45,45,1,timestamp("2021-11-14 11:50:00"),timestamp("2021-11-14 11:50:00"),5,'comment'),
('RDE10052','UID10052','UID00005','completed',45,45,45,45,1,timestamp("2021-11-14 11:28:00"),timestamp("2021-11-14 11:28:00"),5,'comment'),
('RDE10053','UID10053','UID00002','completed',45,45,45,45,1,timestamp("2021-11-14 11:16:00"),timestamp("2021-11-14 11:16:00"),5,'comment'),
('RDE10054','UID10054','UID00003','completed',45,45,45,45,1,timestamp("2021-11-14 11:29:00"),timestamp("2021-11-14 11:29:00"),5,'comment'),
('RDE10055','UID10055','UID00005','completed',45,45,45,45,1,timestamp("2021-11-14 11:53:00"),timestamp("2021-11-14 11:53:00"),5,'comment'),
('RDE10056','UID10056','UID00002','completed',45,45,45,45,1,timestamp("2021-11-14 11:52:00"),timestamp("2021-11-14 11:52:00"),5,'comment'),
('RDE10057','UID10057','UID00003','completed',45,45,45,45,1,timestamp("2021-11-14 11:20:00"),timestamp("2021-11-14 11:20:00"),5,'comment'),
('RDE10058','UID10058','UID00005','completed',45,45,45,45,1,timestamp("2021-11-14 11:21:00"),timestamp("2021-11-14 11:21:00"),5,'comment'),
('RDE10059','UID10059','UID00002','completed',45,45,45,45,1,timestamp("2021-11-14 11:47:00"),timestamp("2021-11-14 11:47:00"),5,'comment'),
('RDE10060','UID10060','UID00002','completed',45,45,45,45,1,timestamp("2021-11-15 11:40:00"),timestamp("2021-11-15 11:40:00"),5,'comment'),
('RDE10061','UID10061','UID00003','completed',45,45,45,45,1,timestamp("2021-11-15 11:38:00"),timestamp("2021-11-15 11:38:00"),5,'comment'),
('RDE10062','UID10062','UID00005','completed',45,45,45,45,1,timestamp("2021-11-15 11:44:00"),timestamp("2021-11-15 11:44:00"),5,'comment'),
('RDE10063','UID10063','UID00002','completed',45,45,45,45,1,timestamp("2021-11-15 11:23:00"),timestamp("2021-11-15 11:23:00"),5,'comment'),
('RDE10064','UID10064','UID00003','completed',45,45,45,45,1,timestamp("2021-11-15 11:46:00"),timestamp("2021-11-15 11:46:00"),5,'comment'),
('RDE10065','UID10065','UID00005','completed',45,45,45,45,1,timestamp("2021-11-15 11:42:00"),timestamp("2021-11-15 11:42:00"),5,'comment'),
('RDE10066','UID10066','UID00002','completed',45,45,45,45,1,timestamp("2021-11-15 11:36:00"),timestamp("2021-11-15 11:36:00"),5,'comment'),
('RDE10067','UID10067','UID00003','completed',45,45,45,45,1,timestamp("2021-11-15 11:13:00"),timestamp("2021-11-15 11:13:00"),5,'comment'),
('RDE10068','UID10068','UID00005','completed',45,45,45,45,1,timestamp("2021-11-15 11:23:00"),timestamp("2021-11-15 11:23:00"),5,'comment'),
('RDE10069','UID10069','UID00002','completed',45,45,45,45,1,timestamp("2021-11-15 11:15:00"),timestamp("2021-11-15 11:15:00"),5,'comment');

INSERT INTO transactionrecord values
('TRN10001', 'ride', timestamp("2021-11-01 12:21:00"), 'success', 119, 'cash'),
('TRN10002', 'ride', timestamp("2021-11-01 12:27:00"), 'success', 127, 'cash'),
('TRN10003', 'ride', timestamp("2021-11-01 12:35:00"), 'success', 148, 'cash'),
('TRN10004', 'ride', timestamp("2021-11-01 12:35:00"), 'success', 112, 'cash'),
('TRN10005', 'ride', timestamp("2021-11-01 12:53:00"), 'success', 107, 'cash'),
('TRN10006', 'ride', timestamp("2021-11-01 12:43:00"), 'success', 75, 'cash'),
('TRN10007', 'ride', timestamp("2021-11-01 12:22:00"), 'success', 130, 'cash'),
('TRN10008', 'ride', timestamp("2021-11-01 12:48:00"), 'success', 104, 'cash'),
('TRN10009', 'ride', timestamp("2021-11-01 12:24:00"), 'success', 50, 'cash'),
('TRN10010', 'ride', timestamp("2021-11-10 12:42:00"), 'success', 133, 'cash'),
('TRN10011', 'ride', timestamp("2021-11-10 12:37:00"), 'success', 119, 'cash'),
('TRN10012', 'ride', timestamp("2021-11-10 12:19:00"), 'success', 76, 'cash'),
('TRN10013', 'ride', timestamp("2021-11-10 12:39:00"), 'success', 139, 'cash'),
('TRN10014', 'ride', timestamp("2021-11-10 12:25:00"), 'success', 106, 'cash'),
('TRN10015', 'ride', timestamp("2021-11-10 12:23:00"), 'success', 113, 'cash'),
('TRN10016', 'ride', timestamp("2021-11-10 12:50:00"), 'success', 75, 'cash'),
('TRN10017', 'ride', timestamp("2021-11-10 12:17:00"), 'success', 74, 'cash'),
('TRN10018', 'ride', timestamp("2021-11-10 12:22:00"), 'success', 61, 'cash'),
('TRN10019', 'ride', timestamp("2021-11-10 12:12:00"), 'success', 116, 'cash'),
('TRN10020', 'ride', timestamp("2021-11-11 12:52:00"), 'success', 57, 'cash'),
('TRN10021', 'ride', timestamp("2021-11-11 12:16:00"), 'success', 104, 'cash'),
('TRN10022', 'ride', timestamp("2021-11-11 12:42:00"), 'success', 68, 'cash'),
('TRN10023', 'ride', timestamp("2021-11-11 12:27:00"), 'success', 150, 'cash'),
('TRN10024', 'ride', timestamp("2021-11-11 12:23:00"), 'success', 79, 'cash'),
('TRN10025', 'ride', timestamp("2021-11-11 12:21:00"), 'success', 50, 'cash'),
('TRN10026', 'ride', timestamp("2021-11-11 12:11:00"), 'success', 114, 'cash'),
('TRN10027', 'ride', timestamp("2021-11-11 12:49:00"), 'success', 114, 'cash'),
('TRN10028', 'ride', timestamp("2021-11-11 12:20:00"), 'success', 147, 'cash'),
('TRN10029', 'ride', timestamp("2021-11-11 12:37:00"), 'success', 83, 'cash'),
('TRN10030', 'ride', timestamp("2021-11-12 12:11:00"), 'success', 131, 'cash'),
('TRN10031', 'ride', timestamp("2021-11-12 12:47:00"), 'success', 129, 'cash'),
('TRN10032', 'ride', timestamp("2021-11-12 12:33:00"), 'success', 137, 'cash'),
('TRN10033', 'ride', timestamp("2021-11-12 12:52:00"), 'success', 89, 'cash'),
('TRN10034', 'ride', timestamp("2021-11-12 12:14:00"), 'success', 124, 'cash'),
('TRN10035', 'ride', timestamp("2021-11-12 12:35:00"), 'success', 95, 'cash'),
('TRN10036', 'ride', timestamp("2021-11-12 12:16:00"), 'success', 143, 'cash'),
('TRN10037', 'ride', timestamp("2021-11-12 12:11:00"), 'success', 74, 'cash'),
('TRN10038', 'ride', timestamp("2021-11-12 12:23:00"), 'success', 144, 'cash'),
('TRN10039', 'ride', timestamp("2021-11-12 12:46:00"), 'success', 53, 'cash'),
('TRN10040', 'ride', timestamp("2021-11-13 12:37:00"), 'success', 128, 'cash'),
('TRN10041', 'ride', timestamp("2021-11-13 12:51:00"), 'success', 143, 'cash'),
('TRN10042', 'ride', timestamp("2021-11-13 12:34:00"), 'success', 92, 'cash'),
('TRN10043', 'ride', timestamp("2021-11-13 12:17:00"), 'success', 146, 'cash'),
('TRN10044', 'ride', timestamp("2021-11-13 12:41:00"), 'success', 71, 'cash'),
('TRN10045', 'ride', timestamp("2021-11-13 12:44:00"), 'success', 110, 'cash'),
('TRN10046', 'ride', timestamp("2021-11-13 12:55:00"), 'success', 78, 'cash'),
('TRN10047', 'ride', timestamp("2021-11-13 12:53:00"), 'success', 150, 'cash'),
('TRN10048', 'ride', timestamp("2021-11-13 12:54:00"), 'success', 75, 'cash'),
('TRN10049', 'ride', timestamp("2021-11-13 12:24:00"), 'success', 83, 'cash'),
('TRN10050', 'ride', timestamp("2021-11-14 12:11:00"), 'success', 143, 'cash'),
('TRN10051', 'ride', timestamp("2021-11-14 12:17:00"), 'success', 120, 'cash'),
('TRN10052', 'ride', timestamp("2021-11-14 12:24:00"), 'success', 137, 'cash'),
('TRN10053', 'ride', timestamp("2021-11-14 12:19:00"), 'success', 101, 'cash'),
('TRN10054', 'ride', timestamp("2021-11-14 12:33:00"), 'success', 97, 'cash'),
('TRN10055', 'ride', timestamp("2021-11-14 12:48:00"), 'success', 61, 'cash'),
('TRN10056', 'ride', timestamp("2021-11-14 12:40:00"), 'success', 127, 'cash'),
('TRN10057', 'ride', timestamp("2021-11-14 12:37:00"), 'success', 77, 'cash'),
('TRN10058', 'ride', timestamp("2021-11-14 12:12:00"), 'success', 138, 'cash'),
('TRN10059', 'ride', timestamp("2021-11-14 12:39:00"), 'success', 85, 'cash'),
('TRN10060', 'ride', timestamp("2021-11-15 12:48:00"), 'success', 120, 'cash'),
('TRN10061', 'ride', timestamp("2021-11-15 12:13:00"), 'success', 78, 'cash'),
('TRN10062', 'ride', timestamp("2021-11-15 12:55:00"), 'success', 50, 'cash'),
('TRN10063', 'ride', timestamp("2021-11-15 12:14:00"), 'success', 96, 'cash'),
('TRN10064', 'ride', timestamp("2021-11-15 12:21:00"), 'success', 52, 'cash'),
('TRN10065', 'ride', timestamp("2021-11-15 12:50:00"), 'success', 60, 'cash'),
('TRN10066', 'ride', timestamp("2021-11-15 12:42:00"), 'success', 80, 'cash'),
('TRN10067', 'ride', timestamp("2021-11-15 12:45:00"), 'success', 118, 'cash'),
('TRN10068', 'ride', timestamp("2021-11-15 12:24:00"), 'success', 146, 'cash'),
('TRN10069', 'ride', timestamp("2021-11-15 12:27:00"), 'success', 145, 'cash');

INSERT INTO ridetransaction values
('TRN10001','RDE10001'),
('TRN10002','RDE10002'),
('TRN10003','RDE10003'),
('TRN10004','RDE10004'),
('TRN10005','RDE10005'),
('TRN10006','RDE10006'),
('TRN10007','RDE10007'),
('TRN10008','RDE10008'),
('TRN10009','RDE10009'),
('TRN10010','RDE10010'),
('TRN10011','RDE10011'),
('TRN10012','RDE10012'),
('TRN10013','RDE10013'),
('TRN10014','RDE10014'),
('TRN10015','RDE10015'),
('TRN10016','RDE10016'),
('TRN10017','RDE10017'),
('TRN10018','RDE10018'),
('TRN10019','RDE10019'),
('TRN10020','RDE10020'),
('TRN10021','RDE10021'),
('TRN10022','RDE10022'),
('TRN10023','RDE10023'),
('TRN10024','RDE10024'),
('TRN10025','RDE10025'),
('TRN10026','RDE10026'),
('TRN10027','RDE10027'),
('TRN10028','RDE10028'),
('TRN10029','RDE10029'),
('TRN10030','RDE10030'),
('TRN10031','RDE10031'),
('TRN10032','RDE10032'),
('TRN10033','RDE10033'),
('TRN10034','RDE10034'),
('TRN10035','RDE10035'),
('TRN10036','RDE10036'),
('TRN10037','RDE10037'),
('TRN10038','RDE10038'),
('TRN10039','RDE10039'),
('TRN10040','RDE10040'),
('TRN10041','RDE10041'),
('TRN10042','RDE10042'),
('TRN10043','RDE10043'),
('TRN10044','RDE10044'),
('TRN10045','RDE10045'),
('TRN10046','RDE10046'),
('TRN10047','RDE10047'),
('TRN10048','RDE10048'),
('TRN10049','RDE10049'),
('TRN10050','RDE10050'),
('TRN10051','RDE10051'),
('TRN10052','RDE10052'),
('TRN10053','RDE10053'),
('TRN10054','RDE10054'),
('TRN10055','RDE10055'),
('TRN10056','RDE10056'),
('TRN10057','RDE10057'),
('TRN10058','RDE10058'),
('TRN10059','RDE10059'),
('TRN10060','RDE10060'),
('TRN10061','RDE10061'),
('TRN10062','RDE10062'),
('TRN10063','RDE10063'),
('TRN10064','RDE10064'),
('TRN10065','RDE10065'),
('TRN10066','RDE10066'),
('TRN10067','RDE10067'),
('TRN10068','RDE10068'),
('TRN10069','RDE10069');

create view topSpenderView as
SELECT SUM(T.amount) as Expense5
FROM User U, Customer C, Ride R, ridetransaction RT, transactionrecord T
WHERE U.user_ID = C.user_ID AND  C.user_ID = R.customer_ID AND 
	R.ride_ID = RT.ride_ID AND RT.transaction_ID = T.transaction_ID AND 
    T.status = 'success' AND T.timestamp BETWEEN DATE("2021-11-01") AND DATE("2021-11-30")
GROUP BY U.user_ID
ORDER BY Expense5 DESC
limit 5;
